<!DOCTYPE html>
<html>
	<head>
    <meta charset="utf-8">
    <title></title>
    <script type="text/javascript" src="js/d3.min.js"></script>
    <link href="css/bootstrap.css" rel="stylesheet" />
    <script type="text/javascript">

    </script>

    <style type="text/css">

		#roundBorder {
		    border-radius: 25px;
		    border: 2px solid #FF1493;
		    padding: 20px;
		    max-width: 500px;
		}

		#header_wrapper{
			background: #373737;
			padding-bottom: 50px;
		}

		#header_wrapper .inner{
			padding: 50px, 10px, 30px, 10px;

		}

		#my_title{
			color: #fff;
			font-size: 42px;

		}

		#my_name{
			font-size: 24px;


		}

		.tab { margin-left: 40px; 
		}

		body{

			margin: 0 auto;
		}

		.inner{
			position: relative;
			max-width: 640px;
			padding: 20px 10px;
			margin: 0 auto;
		}

		.bar:hover {
		  fill: green;
		}

		.bar { fill: #7bcc66; }



	</style>
	</head>

<body>

	<div id="header_wrapper" style="padding-top:10px; padding-left:25px">
		<header class='inner'>
			<h1 id='my_title'>
				Fun with Data
			</h1>
			<h2 id='my_name'>
				Jack<span style="color:#8ACFF6;">Leung</span>
			</h2>
		</header>
	</div>

    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">
		<h1>Improve your health with this d3 barchart tutorial</h1>
		<p>I started learning d3 as part of my current project to make visualizations and was amazed at what I could create with just the basics. So I want to share a bit of what I learned with a tutorial.</p>
		<p>First lets pose a problem. My grandpa Hagrid says the doctor told him he needs more calcium rich foods in his diet. He knows milk is high in calcium but he recently became vegan and he wants to incorporate more raw vegetables in his diet. His eyesight is also very poor so he 
		has trouble reading the small numbers listed on the chart the doctor gave him. I will solve this problem by creating a barchart that will show my grandpa which type of raw vegetables
		provide the highest calcium content.</p>

		<p>Step 1: Define margins and the height and width as the inner dimensions of the drawing space.</p>
	

		<ul id='roundBorder' style="list-style-type:none">
			<li>var margin = {top:50, right: 50, bottom: 50, left: 50},</li>
			<li>width = 300 - margin.left - margin.right,</li>
			<li>height = 300 - margin.top - margin.bottom;</li>
		</ul>

		<p>Step 2: Set x and y scales and the range.</p>

		<ul id='roundBorder' style="list-style-type:none">
			<li>var x = d3.scaleBand()</li>
			<li>.range([0, width])</li>
			<li>.padding(0.1);</li>
			<br></br>
			<li>var y = d3.scaleLinear()</li>
        	<li>.range([height, 0]);</li>
		</ul>

		<p>Step 3: Create the SVG viewport.</p>

		<ul id='roundBorder' style="list-style-type:none">	
			<li>var svg = d3.select("body").append("svg")</li>
			    <li>.attr("width", width + margin.left + margin.right)</li>
			    <li>.attr("height", height + margin.top + margin.bottom)</li>
			  	<li>append("g")</li>
			    <li>.attr("transform", "translate(" + margin.left + "," + margin.top + ")");</li>
        </ul>

        <p>
        	The above code does the following:
        </p>

        <ul>
        	<li> Selects the body and appends a SVG container.</li>
        	<li> Defines the width and height of the SVG container in terms of the width and height of the inner drawing space.</li>
        	<li> Appends a group element which becomes our inner drawing space.</li>
        	<li> Moves it to the right and down according to margins.</li>
        </ul>

        <p>Step 4: Get the Data.</p>

        <ul id='roundBorder' style="list-style-type:none">
			<li>d3.csv("calcium.csv", function(error, data) {</li>
			  <li>if (error) throw error;</li>
		</ul>
        
        <p>Step 4: Use the domain the of data to scale the range.</p>

        <ul id='roundBorder' style="list-style-type:none">
        	<li>x.domain(data.map(function(d) { return d.vegetable; }));</li>
  			<li>y.domain([0, d3.max(data, function(d) { return d.calcium; })]);</li>
  		</ul>

        <p>Step 5: Draw bars using our data.</p>

        	<ul id='roundBorder' style="list-style-type:none">
			  <li >svg.selectAll(".bar")</li>
			    <li>.data(data)</li>
			    <li>.enter().append("rect")</li>
			    <li>.attr("class", "bar")</li>
			    <li>.attr("x", function(d) { return x(d.vegetable); })</li>
			    <li>.attr("width", x.bandwidth())</li>
			    <li>.attr("y", function(d) { return y(d.calcium); })</li>
			    <li>.attr("height", function(d) { return height - y(d.calcium); });</li>
		    </ul>

        <p>
        	The above code does the following:
        </p>

        <ul>
        	<li> Selects all DOM elements of class "bar".</li>
        	<li> Bind our data to these elements.</li>
        	<li> Create placeholder elements for each data element using the enter selection.</li>
        	<li> Append rect elements to the place holder elements.</li>
        	<li> Assign each rect element the class "bar".</li>
        	<li> Set the x position by passing the vegetable name from our data to the x ordinal scaling function which outputs a number in the range we specified earlier.</li>
        	<li> Set the width of each rect according to the x ordinal scaling function.</li>
        	<li> Set the y position similar to how the x position was set.</li>
        	<li> Set the height of each rect as the difference of the hight of the inner drawing space and the scaled calcium qauntity.</li>


        </ul>
        <p>Step 6: Add the X and Y Axis.</p>

        <ul id='roundBorder' style="list-style-type:none">
  			<li>svg.append("g")</li>
      		<li>.attr("transform", "translate(0," + height + ")")</li>
      		<li>.call(d3.axisBottom(x));</li>
      		<br></br>
  			<li>svg.append("g")</li>
      		</li>.call(d3.axisLeft(y));</li>
      	</ul>


		</section>
	</div>

	<!-- load the d3.js library -->    	
<script src='js/d3.min.js'></script>
<script>
	// set the dimensions and margins of the graph
	var margin = {top: 30, right: 20, bottom: 30, left: 60},
	    width = 760 - margin.left - margin.right,
	    height = 500 - margin.top - margin.bottom;

	// set the ranges
	var x = d3.scaleBand()
	          .range([0, width])
	          .padding(0.1);
	var y = d3.scaleLinear()
	          .range([height, 0]);
	          
	// append the svg object to the body of the page
	// append a 'group' element to 'svg'
	// moves the 'group' element to the top left margin
	var svg = d3.select("body").append("svg")
	    .attr("width", width + margin.left + margin.right)
	    .attr("height", height + margin.top + margin.bottom)
	  .append("g")
	    .attr("transform", 
	          "translate(" + margin.left + "," + margin.top + ")");

	// get the data
	d3.csv("data/calcium.csv", function(error, data) {
	  if (error) throw error;

	  // format the data
	  data.forEach(function(d) {
	    d.calcium = +d.calcium;
	  });

	  // Scale the range of the data in the domains
	  x.domain(data.map(function(d) { return d.vegetable; }));
	  y.domain([0, d3.max(data, function(d) { return d.calcium; })]);

	  // append the rectangles for the bar chart
	  svg.selectAll(".bar")
	      .data(data)
	    .enter().append("rect")
	      .attr("class", "bar")
	      .attr("x", function(d) { return x(d.vegetable); })
	      .attr("width", x.bandwidth())
	      .attr("y", function(d) { return y(d.calcium); })
	      .attr("height", function(d) { return height - y(d.calcium); });

	  // add the x Axis
	  svg.append("g")
	      .attr("transform", "translate(0," + height + ")")
	      .style("font-size","15px")
	      .call(d3.axisBottom(x));

	  // add the y Axis
	  svg.append("g")
	  	  .style("font-size","15px")
	      .call(d3.axisLeft(y));

	  // y label
	  svg.append("text")
      	  .attr("transform", "rotate(-90)")
          .attr("y", 0 - margin.left)
          .attr("x",0 - (height / 2))
          .attr("dy", "1em")
          .style("text-anchor", "middle")
          .text("Calcium (mg)"); 

      // title
	  svg.append("text")
        .attr("x", (width / 2))             
        .attr("y", 0 - (margin.top / 2))
        .attr("text-anchor", "middle")  
        .style("font-size", "16px") 
        .style("text-decoration", "underline")  
        .text("Calcium Content per 120g of Raw Vegetable");

	});

</script>
</body>
</html>

